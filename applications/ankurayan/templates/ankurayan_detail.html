{% extends 'base.html' %}

{% load static %}

{% block title %} Ankurayan {{ ankurayan.year }} {% endblock %}

{% block style %}
<!-- Custom CSS -->
<link rel="stylesheet" href="{% static 'css/bandhu.css' %}">
<link rel="stylesheet" href="{% static 'css/ankurayan.css' %}">

<!-- Semantic UI , Used only for Multiple Select in select Acharya Form -->
<!-- <link rel="stylesheet" type="text/css" href="{% static 'css/icon.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/semantic.min.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/mediaquery.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/semantic-notify.css' %}"> -->

{% endblock %}

{% block navbar-links %}
<li class="nav-item">
    <a class="nav-link px-3 px-lg-2" href="{% url 'home' %}">Home</a>
</li>
<li class="nav-item">
    <a class="nav-link px-3 px-lg-2" href="#about">About</a>
</li>
<!-- <li class="nav-item">
    <a class="nav-link px-3 px-lg-2" href="#recent-activities">Recents</a>
</li> -->
<li class="nav-item">
    <a class="nav-link px-3 px-lg-2" href="#gallery">Gallery</a>
</li>
<li class="nav-item">
    <a class="nav-link px-3 px-lg-2" href="#contact">Contact</a>
</li>
<li class="nav-item">
    <a class="nav-link px-3 px-lg-2" href="{% url 'profile_page' %}" style="text-transform: none;">{{ user.email }}</a>
</li>
{% endblock %}

{% block showcase-title-container %}
<div class="slider-txt-container" style="padding: 200px 0 200px 0;">
    <h2 class="bold-txt"> Ankurayan {{ ankurayan.year }} </h2>
</div>
{% endblock %}

{% block content %}
<!-- About Section  -->
<section id="about" style="margin-top: -200px;">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-9 text-left px-0 py-0 py-lg-2 mx-auto" style="z-index: 10;">


                <div class="card m-2 shadow-sm d-none d-lg-block">
                    <div class="card-body p-4">
                        <h1 class="mb-3 title">{{ ankurayan.title|safe }}</h1>
                        <p class="m-0">
                            {{ ankurayan.theme }}
                        </p>
                    </div>
                </div>
                <!--   DESCRIPTON  -->
                <div class="card m-2 shadow-sm">
                    <div class="card-body p-4">
                        <h2 class="content-title mb-2">Description</h1>
                        <p>{{ ankurayan.description|safe }}</p>
                    </div>
                </div>


                <!-- <div style="padding: 165px 25px 0;">
                    <h3 class="content-title" style="font-size: 2rem; margin-bottom: 20px;">{{ankurayan.theme}} -
                        {{ankurayan.year}}</h3>
                    <p>
                        <strong>
                            {{ankurayan.start_date}} - {{ankurayan.end_date}}
                        </strong>
                    </p>
                    <p>
                        {{ankurayan.description}}
                    </p>
                    </h3>
                </div> -->


                <!-- ACTIVITIES -->
                <!-- <div class="card m-2 mt-3 shadow-sm">
                    <div class="card-body p-4">
                        <h2 class="content-title mb-2">Activities</h1>
                        <p>{{ ankurayan.description|safe }}</p>
                    </div>
                </div> -->
                

                {% if check_admin and user.is_authenticated %}
                <!-- Add Guest to this Ankurayan -->
                <div class="select-acharyas">
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addGuest">
                        Add Guest
                    </button>
                    <div class="modal fade bd-example-modal-lg" tabindex="-1" id="addGuest" role="dialog"
                        aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Add Guest</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form method="POST" action="{% url 'ankurayan:AddGuest' %}">{% csrf_token %}
                                        <input type="text" hidden name="slug" value={{ankurayan.slug}}>
                                        <input type="text" class="form-control" name="name"
                                            placeholder="Guest Name"><br>
                                        <input type="text" class="form-control" name="contact_no"
                                            placeholder="Contact number"><br>
                                        <input type="text" class="form-control" name="profession"
                                            placeholder="Profession"><br>
                                        <input type="text" class="form-control" name="email"
                                            placeholder="Email"><br>
                                        <textarea name="about" cols="80" rows="8" class="form-control"></textarea><br>
                                        <button class="btn btn-primary">Submit</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add Participants to this Ankurayan -->
                <div class="add-participants">
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addParticipantsModal">
                        Add Participants
                    </button>
                    <div class="modal fade bd-example-modal-lg" tabindex="-1" id="addParticipantsModal" role="dialog"
                        aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Add Participants</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form method="POST" action="{% url 'ankurayan:AddParticipant' %}">{% csrf_token %}
                                        <input type="text" hidden name="slug" value={{ankurayan.slug}}>
                                        <input type="text" class="form-control" name="name"
                                            placeholder="Student name"><br>
                                        <select class="form-control" name="gender">
                                            <option value="M">Male</option>
                                            <option value="F">Female</option>
                                            <option value="O">Other</option>
                                        </select><br>
                                        <select class="form-control" name="school_class">
                                            <option value="I">Class I</option>
                                            <option value="II">Class II</option>
                                            <option value="III">Class III</option>
                                            <option value="IV">Class IV</option>
                                            <option value="V">Class V</option>
                                            <option value="VI">Class VI</option>
                                            <option value="VII">Class VII</option>
                                            <option value="VIII">Class VIII</option>
                                            <option value="IX">Class IX</option>
                                            <option value="X">Class X</option>
                                            <option value="XI">Class XI</option>
                                            <option value="XII">Class XII</option>
                                        </select><br>
                                        <input type="text" class="form-control" name="address"
                                            placeholder="Student Address"><br>
                                        <input type="text" class="form-control" name="contact_no"
                                            placeholder="Guardian Contact number"><br>
                                        <button class="btn btn-primary">Submit</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add Activity Category -->
                <div class="add-activity-category">
                    <button type="button" class="btn btn-primary" data-toggle="modal"
                        data-target="#addActivityCategory">
                        Add Category
                    </button>
                    <div class="modal fade bd-example-modal-lg" tabindex="-1" id="addActivityCategory" role="dialog"
                        aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Add Activity Category</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form method="POST" action="{% url 'ankurayan:AddActivityCategory' %}">{% csrf_token %}
                                        <input type="text" hidden name="slug" value={{ankurayan.slug}}>
                                        <input type="text" class="form-control" name="name"
                                            placeholder="Category name"><br>
                                        <button class="btn btn-primary">Submit</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add Activity -->
                <div class="add-activity">
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addActivity">
                        Add Activity
                    </button>
                    <div class="modal fade bd-example-modal-lg" tabindex="-1" id="addActivity" role="dialog"
                        aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Add Activity</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form method="POST" enctype="multipart/form-data" action="{% url 'ankurayan:CreateActivity' %}">{% csrf_token %}
                                        <input type="text" hidden name="slug" value={{ankurayan.slug}}>
                                        <input type="text" class="form-control" name="activity_name"
                                            placeholder="Activity name"><br>
                                        <select class="form-control" name="category">
                                            {% for category in categories %}
                                            <option value="{{category.pk}}">{{category.name}}</option>
                                            {% endfor %}
                                        </select><br>
                                        <input type="date" name="activity_date" class="form-control"><br>
                                        <textarea name="description" cols="80" class="form-control"
                                            rows="8"></textarea><br>
                                        <input type="file" class="form-control" multiple name="activity_images">
                                        <button class="btn btn-primary">Submit</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}

            </div>
            <div class="col-lg-3 text-left px-0 py-0 py-lg-2 mx-auto" style="z-index: 10;">
				<!--   PIC CARD  -->
				<div class="card m-2 shadow-sm">
					<div class="card-body p-1">
						<img src="{{ ankurayan.logo.url }}" alt="DP" class="img-fluid h-100 w-100" style="max-height: 300px;" />
					</div>
                </div>
                <!--  SCHEDULE  -->
                <div class="card m-2 shadow-sm">
                    <div class="card-header">
                        <i class="fas fa-clock pr-2"></i>
                        Schedule
                    </div>
                    <div class="card-body">
                        <p class="font-weight-normal mb-1">

                            <span>Starts on <b>{{ankurayan.start_date|date:"d M, o"}}</b></span>
                            <br>
                            <span>Ends on <b>{{ankurayan.end_date|date:"d M, o"}}</b></span>
                        </p>
                    </div>
                </div>
            </div>
            <!-- <div class="col-md-6">
                <div class="card border text-center">
                    <img class="card-img-top" src='/media/{{ankurayan.logo}}' alt="Card image cap"
                        style="height: 400px; width: 100%;">
                </div>
            </div> -->
        </div>
    </div>
</section>

<!-- Activities Section -->
<section id="activities" class="mb-5">
    <h3 class="section-title mt-5 pt-3 pt-sm-0">Activities</h3>
    <div class="container">
        {% for category in categories %}
        {% if category.activity_set.count %}
        <h3 class="title mt-5 mb-3">{{ category.name }}</h3>
        <div class="row">
            <div class="glide category{{ forloop.counter0 }}">
                <div class="glide__track" data-glide-el="track">
                    <ul class="glide__slides">
                        {% for activity in category.activity_set.all %}
                        <li class="glide__slide">
                            <div class="card w-100 shadow-sm border border-primary border-rounded mx-auto my-2">
                                <a class="" href="#" data-toggle="modal" data-target="#activity_modal{{ activity.id }}">
                                <img src="{% static 'img/pimg6.jpg' %}" class="card-img-top home-card-img" alt="" width="300px">
                                </a>
                                <div class="card-body pb-0">
                                    <a class="" href="#" data-toggle="modal" data-target="#activity_modal{{ activity.id }}" style="text-decoration: none; color: black !important;">
                                    <h5 class="card-title font-weight-bold">{{ activity.name }}</h5>
                                    </a>
                                    <p class="mb-3">
                                    {% if check_admin and user.is_authenticated %}
                                        {% if activity.winner %}
                                        {% else %}
                                            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#selectWinners{{forloop.counter}}">Add Winners</button>
                                        {% endif %}
                                    {% endif %}
                                    <br>
                                    
                                    </p>
                                </div>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="glide__arrows disable_arrows d-none d-md-block" data-glide-el="controls">
                    <button class="slider_arrow slider_arrow--prev glide__arrow glide__arrow--left" data-glide-dir="<">
                        <i class="fas fa-arrow-circle-left"></i>
                    </button>
                    <button class="slider_arrow slider_arrow--next glide__arrow glide__arrow--right" data-glide-dir=">">
                        <i class="fas fa-arrow-circle-right"></i>
                    </button>
                </div>
                <div class="glide__bullets" data-glide-el="controls[nav]">
                    {% for activity in category.activity_set.all %}
                    <button class="glide__bullet" data-glide-dir="={{ forloop.counter0 }}"></button>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endif %}
        {% endfor %}
    </div>
</section>

<!-- ACTIVITIES MODALS -->
{% for category in categories %}
    {% for activity in category.activity_set.all %}
    <div class="modal fade" id="activity_modal{{ activity.id }}">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content shadow">
                <div class="modal-header">
                    <h5 class="modal-title content-title">{{ activity.name }}</h5>
                    <button type="button" class="close" style="padding: .5rem 1rem;" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true" style="font-size: 2.375rem;">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6 col-lg-6 align-self-center">
                            <div id="mission-carousel" class="mission-carousel carousel slide m-auto" data-ride="carousel">
                                <ul class="carousel-indicators">
                                    <li data-target="#mission-carousel" data-slide-to="0" class=""></li>
                                    <li data-target="#mission-carousel" data-slide-to="1" class=""></li>
                                    <li data-target="#mission-carousel" data-slide-to="2" class="active"></li>
                                </ul>
                                <div class="carousel-inner">
                                    <div class="carousel-item">
                                        <img src="/static/img/pimg6.jpg" alt="carousel image">
                                    </div>
                                    <div class="carousel-item">
                                        <img src="/static/img/pimg2.jpg" alt="carousel image">
                                    </div>
                                    <div class="carousel-item active">
                                        <img src="/static/img/pimg3.jpg" alt="carousel image">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h3 class="font-weight-bolder">Description</h3>
                            {{ activity.description }}
                            {% if activity.winner %}
                            <h3 class="font-weight-bolder">Result</h3>
                            <p><b>Winner:</b>{{ activity.winner }}</p>
                            <p><b>Runner Up1:</b>{{ activity.runner_up1 }}</p>
                            <p><b>Runner Up2:</b>{{ activity.runner_up2}}</p>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    {% if check_admin and user.is_authenticated %}
    <div class="modal fade" tabindex="-1"
        id="selectWinners{{forloop.counter}}" role="dialog"
        aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content shadow">
                <div class="modal-header">
                    <h5 class="modal-title content-title" id="exampleModalLongTitle">Select Winners
                    </h5>
                    <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p style="color:red;display:none;" class="errorMessageWinners" >A student cannot come at two positions.</p>
                    <form method="POST" enctype="multipart/form-data" action="{% url 'ankurayan:AddWinners' %}"
                        id="chooseWinnersForm{{forloop.counter}}">{% csrf_token %}
                        <input type="text" hidden name="pk" value="{{activity.pk}}">
                        <input type="text" hidden name="slug" value="{{ankurayan.slug}}">
                        <!-- <input type="text" hidden name="activity_name"
                            value={{activity.activity_name}}>
                        <input type="text" hidden name="date"
                            value={{activity.activity_date}}> -->
                        <select required class="form-control" id="winner{{forloop.counter}}"
                            name="pk_winner">
                            <option value="">Select Winner</option>
                            {% for participant in participants %}
                            <option value="{{participant.pk}}">{{participant.name}} -
                                {{participant.school_class}}</option>
                            {% endfor %}
                        </select><br>
                        <select required class="form-control" id="runnerUp1{{forloop.counter}}"
                            name="pk_runner_up1">
                            <option value="">Select first runner up</option>
                            {% for participant in participants %}
                            <option value="{{participant.pk}}">{{participant.name}} -
                                {{participant.school_class}}</option>
                            {% endfor %}
                        </select><br>
                        <select required class="form-control" id="runnerUp2{{forloop.counter}}"
                            name="pk_runner_up2">
                            <option value="">Select second runner up</option>
                            {% for participant in participants %}
                            <option value="{{participant.pk}}">{{participant.name}} -
                                {{participant.school_class}}</option>
                            {% endfor %}
                        </select><br>
                        <input type="file" class="form-control" multiple name="activity_images">
                        <button type="button" class="btn btn-primary"
                            onclick="validateWinners(`{{forloop.counter}}`);">Submit</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    {% endfor %}
{% endfor %}

<!-- ANKURAYANS SECTION -->
<section id="ankurayans">
    <div class="bg-grey" style="padding: 50px 0;">
        <h3 class="section-title">Ankurayans</h3>
        <div class="container">
            <div class="row">
                <div class="glide ankurayans">
                    <div class="glide__track" data-glide-el="track">
                        <ul class="glide__slides">
                            {% for ankur in ankurayans %}
                            <li class="glide__slide">
                                <div class="card w-100 shadow-sm border border-primary border-rounded mx-auto my-2">
                                    <img src="{{ ankur.logo.url }}" class="card-img-top home-card-img" alt="" width="300px" >
                                    <div class="card-body pb-0">
                                        <h5 class="card-title font-weight-bold">{{ankur.title}}</h5>
                                        <p class="mb-3">
                                            {{ankur.theme}}<br>
                                        </p>
                                        <a href="{% url 'ankurayan:AnkurayanDetail' ankur.slug %}" class="stretched-link"></a>
                                    </div>
                                </div>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="glide__arrows disable_arrows d-none d-md-block" data-glide-el="controls">
                        <button class="slider_arrow slider_arrow--prev glide__arrow glide__arrow--left" data-glide-dir="<">
                            <i class="fas fa-arrow-circle-left"></i>
                        </button>
                        <button class="slider_arrow slider_arrow--next glide__arrow glide__arrow--right" data-glide-dir=">">
                            <i class="fas fa-arrow-circle-right"></i>
                        </button>
                    </div>
                    <div class="glide__bullets" data-glide-el="controls[nav]">
                        {% for ankur in ankurayans %}
                        <button class="glide__bullet" data-glide-dir="={{ forloop.counter0 }}"></button>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<!-- Activities Section -->
<!-- <section id="ankurayans">
    <div class="bg-grey" style="padding: 50px 0;">
        <div class="container">
            <div class="row">
                <div class="section-content w-100">
                    <div class="content-box from-bottom delay-200">
                        <h3 class="section-title">Ankurayans</h3>
                        <div class="glide">
                            <div class="glide__track" data-glide-el="track">
                                <ul class="glide__slides">
                                    {% for ankur in ankurayans %}
                                    <li class="glide__slide">
                                        <div
                                            class="card w-100 shadow-sm border border-primary border-rounded mx-auto my-2">
                                            <img src="{{ ankur.logo.url }}" class="card-img-top home-card-img"
                                                alt="" width="300px">
                                            <div class="card-body pb-0">
                                                <h5 class="card-title font-weight-bold">{{ankur.title}}</h5>
                                                <p class="m-2 font-italic  font-open-sans mb-3">
                                                    {{ankur.theme}}
                                                    <br>
                                                </p>
                                                <a href="{% url 'ankurayan:AnkurayanDetail' ankur.slug %}" class="stretched-link"></a>
                                            </div>
                                        </div>
                                        {% if check_admin and user.is_authenticated %}
                                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#selectWinners{{forloop.counter}}">Add Winners</button>
                                        {% endif %}
                                    </li>
                                    {% if check_admin and user.is_authenticated %}
                                    <div class="modal fade bd-example-modal-lg" tabindex="-1"
                                        id="selectWinners{{forloop.counter}}" role="dialog"
                                        aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                                        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLongTitle">Select Winners
                                                    </h5>
                                                    <button type="button" class="close" data-dismiss="modal"
                                                        aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <p style="color:red;display:none;" class="errorMessageWinners" >A student cannot come at two positions.</p>
                                                    <form method="POST" enctype="multipart/form-data" action="{% url 'ankurayan:AddWinners' %}"
                                                        id="chooseWinnersForm{{forloop.counter}}">{% csrf_token %}
                                                        <input type="text" hidden name="slug" value={{kendra.slug}}>
                                                        <input type="text" hidden name="activity_name"
                                                            value={{activity.activity_name}}>
                                                        <input type="text" hidden name="date"
                                                            value={{activity.activity_date}}>
                                                        <select required class="form-control" id="winner{{forloop.counter}}"
                                                            name="pk_winner">
                                                            <option value="">Select Winner</option>
                                                            {% for participant in participants %}
                                                            <option value="{{participant.pk}}">{{participant.name}} -
                                                                {{participant.school_class}}</option>
                                                            {% endfor %}
                                                        </select><br>
                                                        <select required class="form-control" id="runnerUp1{{forloop.counter}}"
                                                            name="pk_runner_up1">
                                                            <option value="">Select first runner up</option>
                                                            {% for participant in participants %}
                                                            <option value="{{participant.pk}}">{{participant.name}} -
                                                                {{participant.school_class}}</option>
                                                            {% endfor %}
                                                        </select><br>
                                                        <select required class="form-control" id="runnerUp2{{forloop.counter}}"
                                                            name="pk_runner_up2">
                                                            <option value="">Select second runner up</option>
                                                            {% for participant in participants %}
                                                            <option value="{{participant.pk}}">{{participant.name}} -
                                                                {{participant.school_class}}</option>
                                                            {% endfor %}
                                                        </select><br>
                                                        <input type="file" class="form-control" multiple name="activity_images">
                                                        <button type="button" class="btn btn-primary"
                                                            onclick="validateWinners(`{{forloop.counter}}`);">Submit</button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {% endif %}
                                    {% endfor %}
                                </ul>
                            </div>
                            <div class="glide__arrows disable_arrows d-none d-md-block" data-glide-el="controls">
                                <button class="slider_arrow slider_arrow--prev glide__arrow glide__arrow--left"
                                    data-glide-dir="<">
                                    <i class="fas fa-arrow-circle-left"></i>
                                </button>
                                <button class="slider_arrow slider_arrow--next glide__arrow glide__arrow--right"
                                    data-glide-dir=">">
                                    <i class="fas fa-arrow-circle-right"></i>
                                </button>
                            </div>
                            <div class="glide__bullets" data-glide-el="controls[nav]">
                                {% for activity in activities %}
                                <button class="glide__bullet" data-glide-dir="={{forloop.counter}}"></button>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section> -->
<!-- Recent Activities Section Ends -->
<!-- Volunteer Section -->
<section id="volunteer">
    <div class="parallax-style text-white text-center">
        <div class="parallax-overlay dark-overlay section-padding" style="padding: 80px 0 70px;">
            <div class="container">
                <div class="section-head" style="margin-bottom:60px;">
                    <h3 class="section-title parallax-title">
                        Become a Volunteer
                    </h3>
                </div>

                <div class="row justify-content-center">
                    <p class="parallax-description w-100 px-3"
                        style="font-size:1.7em; line-height:35px; margin-bottom: 30px;">
                        Do you like to work for children? Do you feel the slogan "Save the Children". Yes. Here, you are
                        welcome to our team and you can work as a volunteer.
                    </p>
                    <button type="button" class="btn btn-outline-light py-2 px-4 custom-btn angle-effect">Join
                        Now</button>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Volunteer Section End-->

<section id="gallery">
    <div class="bg-grey" style="padding: 80px 0 60px;">
        <div class="container">
            <div class="section-head">
                <h2 class="section-title">
                    Gallery
                </h2>
                <p class="section-description">
                    TAKE A LOOK AT OUR GALLERY TO SEE HOW WE ENDANGER THE CHILD. YOU MAY ALSO SEE OUR WORLDWIDE ACTIVITY
                    AROUND THE GLOBE HOW WE WORKING FOR CHILDREN.
                </p>
            </div>

            <div id="gallery-container" class="gallery-container">
                <div class="galleryFilter">
                    <a href="#" data-filter="" class="current">All</a>
                    {% for category in categories %}
                        {% if category.activity_set.count %}
                        <a href="#" data-filter=".{{ category.name }}">{{ category.name }}</a>
                        {% endif %}
                    {% endfor %}
                </div>

                <div class="gallery-item element-from-bottom clearfix">
                    {% for photo in photos %}
                    <figure class="item {{ photo.activity.category.name }} photo-{{ photo.id }}">
                        <img src='{{ photo.picture.url }}' data-rel="photoSwipe">
                        <a href="javascript:pswpInit({{ forloop.counter0 }})" class="stretched-link">
                            <i class="fab fa-instagram"></i>
                        </a>
                    </figure>
                    {% endfor %}
                </div>
            </div>

            <div id="gallery-container" class="gallery-container">
                <div class="add-images">
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addToGallery">
                        Upload Images
                    </button>
                    <div class="modal fade bd-example-modal-lg" tabindex="-1" id="addToGallery" role="dialog"
                        aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Upload Images</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form method="POST" enctype="multipart/form-data" action="{% url 'ankurayan:AddToGallery' %}">{% csrf_token %}
                                        <input type="text" hidden name="slug" value={{ankurayan.slug}}>
                                        
                                        <input type="file" class="form-control" multiple name="gallery_images">
                                        <button class="btn btn-primary">Submit</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- <div class="gallery-item element-from-bottom clearfix">

                    {% for photo in photos %}
                    <figure class="item cat-3 cat-4">
                        <img src='/media/{{photo.picture}}' alt="Item 3" data-rel="photoSwipe">
                        <a href="" class="stretched-link">
                            <i class="fab fa-instagram"></i>
                        </a>
                    </figure>
                    {% if not photo.approved %}
                    <button type="button" onclick="imageApproval('approve','{{photo.pk}}');">Approve</button>
                    <button type="button" onclick="imageApproval('discard','{{photo.pk}}');">Discard</button>
                    {% endif %}
                    {% endfor %}        

                </div> -->
            </div>
        </div>
    </div>
</section>

<!-- Include PhotoSwipe -->
{% include 'snippets/init_pswp.html' %}

<!-- Scroll To Top Button -->
<div id="scroll-to-top">
    <div class="hex scroll-top">
        <span><i class="fa fa-arrow-up"></i></span>
    </div>
</div>

{% endblock %}


{% block scripts %}
<!-- PHOTOSWIPE -->
<script>
    // build the json album images collection 
    window.djangoAlbumImages = [
        {% for photo in photos %}
            {
                src: '{{ photo.picture.url }}',
                w:  {{ photo.picture.width }},
                h:  {{ photo.picture.height }}
            },
        {% endfor %}
    ];

    // Change album on filtering images
    $('#gallery-container .galleryFilter a').on("click", function(){
        let filter = $(this).data('filter');
        
        if (filter == ""){
            window.djangoAlbumImages = [
                {% for photo in photos %}
                    {
                        src: '{{ photo.picture.url }}',
                        w:  {{ photo.picture.width }},
                        h:  {{ photo.picture.height }}
                    },
                {% endfor %}
            ];

            $('#gallery-container .gallery-item a').each(function(index, img){
                $(img).attr("href", 'javascript:pswpInit(' + index + ')');
            });
        }
        else{
            category = filter.slice(1);

            window.djangoAlbumImages = [];

            {% for photo in photos %}
            if("{{ photo.activity.category.name }}" == category){
                window.djangoAlbumImages.push(
                    {
                        src: '{{ photo.picture.url }}',
                        w:  {{ photo.picture.width }},
                        h:  {{ photo.picture.height }}
                    }
                );
            }
            {% endfor %}

            let selector = '#gallery-container ' + filter + ' a';
            $(selector).each(function(index, img){
                $(img).attr("href", 'javascript:pswpInit(' + index + ')');
            });
        }

    });
</script>
<!-- Custom JS -->
<script src="{% static 'js/ankurayan.js' %}"></script>
<!-- Contact Scrollspy Problem -->
<script>contact_scrollspy()</script>

<!-- Semantic UI -->

<!-- <script type="text/javascript" src="{% static 'js/jquery.min.js' %}"> </script>
<script type="text/javascript" src="{% static 'js/semantic-notify.js' %}"> </script>

<script type="text/javascript" src="{% static 'js/semantic.min.js' %}"></script>
<script type="text/javascript" src="{% static 'js/dropdown.js' %}"></script> -->

<script>
    $(document).ready(function () {
        $('.ui.dropdown').dropdown();
    });

    function validateWinners(counter) {
        // alert(counter)
        var winner = document.getElementById(`winner${counter}`).value;
        var runner_up1 = document.getElementById(`runnerUp1${counter}`).value;
        var runner_up2 = document.getElementById(`runnerUp2${counter}`).value;

        if(winner == runner_up1 || winner == runner_up2 || runner_up1 == runner_up2) {
            document.getElementsByClassName('errorMessageWinners')[0].style.display = "grid";
            return;
        }
        $('#chooseWinnersForm'+counter).submit();
    }

    function imageApproval(status, image) {
        var ankurayan = "{{ankurayan.slug}}";
        $.ajax({
            type: "POST",
            url: "/ankurayan/admin_approval/",
            data: {
                status: status,
                image: image,
                ankurayan: ankurayan,
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            success: function (data1) {
                var data = JSON.parse(data1);
                $('#galleryBox').empty();
                for(let photo=0;photo<data.length;photo++){
                    var k = data[photo].fields.approved;
                    var ele = `<figure class="item cat-3 cat-4" style="width: 267px; height: 183.9px;">
                        <img src='/media/${data[photo].fields.picture}' alt="Item 3" data-rel="photoSwipe">
                        <a href="" class="stretched-link">
                            <i class="fab fa-instagram"></i>
                        </a>
                    </figure>`
                    if(!k) {
                        ele += `
                        <button type="button" onclick="imageApproval('approve','${data[photo].pk}');">Approve</button>
                        <button type="button" onclick="imageApproval('discard','${data[photo].pk}');">Discard</button>
                        `
                    }
                    $('#galleryBox').append(ele);
                }
            }
        });
    }

</script>

<script>
    // ACTIVITIES CAROUSEL
    {% for category in categories %}
    {% if category.activity_set.count %}
        var glide = new Glide('.category{{forloop.counter0}}',{
            type: 'carousel',
            focusAt: 'center',
            perView: 3,
            autoplay: 2000,
            gap: 30,
            breakpoints: {
                991: {
                    perView: 2,
                },
                767:{
                    perView: 1,
                }
            }
        })
        glide.mount()
    {% endif %}
    {% endfor %}

    // ANKURAYANS CAROUSEL
    var ankur_glide = new Glide('.ankurayans',{
        type: 'slide',
        focusAt: 'center',
        perView: 3,
        autoplay: 2000,
        gap: 30,
        breakpoints: {
            991: {
                perView: 2,
            },
            767:{
                perView: 1,
            }
        }
    })
    ankur_glide.mount()
</script>

{% endblock %}