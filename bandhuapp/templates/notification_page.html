{% comment %} {% extends 'base.html' %} {% endcomment %}

{% load static %}


{% comment %} {% load permissions %} {% endcomment %}

{% comment %} {% block title %} Bandhu {% endblock %} {% endcomment %}

{% block style %}
<!-- Custom CSS -->
<link rel="stylesheet" href="{% static 'css/bandhu.css' %}" >
<link rel="stylesheet" href="{% static 'vendor/css/bootstrap-select.min.css' %}">

<!-- Custom Style -->
{% comment %} <style>
    #top-section {
        background: url("{{ content.banner_image.url }}") 50% center no-repeat fixed;
    }
</style> {% endcomment %}
{% endblock %}


{% comment %} {% block content %} {% endcomment %}

<!-- Recent Activities tab -->

<!-- Modal to show activity -->

{% comment %} <div class="modal" id="recent-activity-modal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content recent-activity-modal-content">
        <div class="recent-activity-modal-header">Activity</div>
        <a href="#" target="_blank" class="recent-activity-modal-title">Title</a>
        <div class="recent-activity-modal-desc">Description..</div>
      <img src="#" class="recent-activity-modal-image"/>
    </div>
  </div>
</div>  {% endcomment %}



<div class="recent-activities2">
    <div class="recent-activities-head2">
        NOTICE BOARD
    </div>

 {% comment %} <div class="shadow-sm" > {% endcomment %}
        <div class="card card-body recent-activity-card2">
            <ol class="recent-activity-ol">
                {% for act in recentActivities %}
                    {% if act.end_date %}
                        <!-- If it is an event. So, keep "New" until event is over -->
                        {% if act.end_date|date:"Y-m-d" >= curr_date|date:"Y-m-d" %}
                        <div class="ribbon-new2">New</div>
                        {% endif %}
                    {% elif act.start_date %}
                        {% if act.start_date|date:"Y-m-d" > act.date_created|date:"Y-m-d" and act.start_date|date:"Y-m-d" >= curr_date|date:"Y-m-d" %}
                        <!-- If it is a one day event, keep "New" until event is over -->
                        <div class="ribbon-new2">New</div>
                        {% elif act.start_date|date:"Y-m-d" == act.date_created|date:"Y-m-d" and act.start_date|date:"Y-m-d" >= seven_day_delta|date:"Y-m-d" %}
                        <!-- If it is a notifiation, keep "New" for 7 days -->
                        <div class="ribbon-new2">New</div>
                        {% endif %}
                    {% else %}
                        <!-- If no date is mentioned, keep "New" for 7 days -->
                        {% if act.date_created|date:"Y-m-d" >= seven_day_delta|date:"Y-m-d" %}
                        <div class="ribbon-new2">New</div>
                        {% endif %}
                    {% endif %}
                    
                    <a href="{{ act.link }}" id="{{ act.id }}" class="recent-activity-bar" target="_blank" style="font-size: 20px; text-decoration: none;">
                        <li class="recent-activity-li">
                            {{ act.title }}
                            <p style="font-size: 13px;">{{ act.description|truncatechars:135 }}</p>
                            {% if act.start_date %}
                            <p style="font-size: 12px; font-weight: bolder; float: right; margin-top:-18px; margin-right: -30px;">
                                <i class="far fa-calendar-alt"></i>
                                {% if act.end_date %}
                                    {% if act.start_date|date:"Y" != act.end_date|date:"Y" %}
                                        {{ act.start_date }} - {{ act.end_date }}
                                    {% elif act.start_date|date:"M" != act.end_date|date:"M" %}
                                        {{ act.start_date|date:"M d" }} - {{ act.end_date|date:"M d" }}, {{ act.start_date.year }}
                                    {% elif act.start_date|date:"d" != act.end_date|date:"d" %}
                                        {{ act.start_date|date:"M" }} {{ act.start_date|date:"d" }} - {{ act.end_date|date:"d" }}, {{ act.start_date.year }}
                                    {% else %}
                                        {{ act.start_date }}
                                    {% endif %}
                                {% else %}
                                    {{ act.start_date }}
                                {% endif %}
                            </p>
                            {% endif %}
                        </li>
                    </a> 
                {% endfor %}
            </ol>
        </div>
 {% comment %} </div> {% endcomment %}
</div>

{% comment %} {% block Pagination %} {% endcomment %}


  <div style="
    width: 80% !important;
    margin: 9px auto auto auto;
    text-align: right;">
    {% if recentActivities.has_previous %}
      <a 
      style=
      "padding: 4px 12px 4px 12px;
       background-color: orange;
       color: white;
       text-decoration: none;
       border-radius: 5px;
       font-size: 16px;"
       href="?page=1">&laquo; First</a>
      <a
       style=
       "padding: 4px 12px 4px 12px;
        background-color: orange;
        color: white;
        text-decoration: none;
        border-radius: 5px;
        font-size: 16px;"
        href="?page={{recentActivities.previous_page_number}}">Previous</a>
    {% endif %}

    Page {{recentActivities.number}} of {{recentActivities.paginator.num_pages}}

    {% if recentActivities.has_next %}
        <a 
        style=
        "padding: 4px 12px 4px 12px;
         background-color: orange;
         color: white;
         text-decoration: none;
         border-radius: 5px;
         font-size: 16px;"
         href="?page={{recentActivities.next_page_number}}">next</a> 
        <a 
        style=
        "padding: 4px 12px 4px 12px;
         background-color: orange;
         color: white;
         text-decoration: none;
         border-radius: 5px;
         font-size: 16px;"
         href="?page={{recentActivities.paginator.num_pages}}">Last &raquo;</a> 
    {% endif %}
  </div>

  {% comment %} {% endblock %} {% endcomment %}
{% comment %}  {% endcomment %}

{% block scripts %}

<script>
    function isImage(url) {
         return /\.(jpg|jpeg|png|webp|avif|gif|svg)$/.test(url);
    }
    const recent_activity_data = {};
    "{% for act in recent_activities %}"
        recent_activity_data["{{ act.id }}"] = {title:"{{ act.title }}",description:"{{ act.description }}"}
    "{% endfor %}"
    document.querySelectorAll('.recent-activity-bar').forEach((element)=>{
        element.addEventListener('click',(e)=>{
            e.preventDefault();
            const data = recent_activity_data[element.id];
            if(isImage(element.href)){
                const image = document.querySelector('.recent-activity-modal-image');
                image.style.display = 'block';
                image.src = element.href;
                image.addEventListener('click',(e)=>{
                    window.open(element.href)
                })
            }
            else{
                document.querySelector('.recent-activity-modal-image').style.display = 'none';
            }
            const title = document.querySelector('.recent-activity-modal-title');
            const description = document.querySelector('.recent-activity-modal-desc')
            title.innerText = data.title;
            title.href = element.href;
            description.innerText = data.description;
            $("#recent-activity-modal").modal('toggle');
        })
    })
</script>


<!-- Custom JS -->
<script src="{% static 'js/bandhu.js' %}"></script>
<script src="{% static 'vendor/js/bootstrap-select.min.js' %}"></script>



<!-- RECENT ACTIVITIES CAROUSEL -->
<script>
    var glide = new Glide('.glide',{
        type: 'carousel',
        focusAt: 'center',
        perView: 3,
        autoplay: 2000,
        gap: 30,
        breakpoints: {
            991: {
                perView: 2,
            },
            767: {
                perView: 1,
            },
        }
    })
    glide.mount()
</script>
{% endblock %}
